---
phase: 02-modal-components
plan: 03
type: execute
wave: 3
depends_on: ['02-02']
files_modified:
  - src/components/changelog/version-accordion.tsx
  - src/locales/en/translation.json
  - src/locales/no/translation.json
autonomous: false

must_haves:
  truths:
    - 'Multiple versions display in accordion with latest expanded'
    - 'Older versions are collapsed by default'
    - "5+ versions shows only 3 with '+ N older versions' button"
    - "Accordion labels show 'v{version} - {date}' format"
    - 'All changelog UI text is translatable via i18n'
    - 'Modal opens and dismisses correctly on desktop and mobile'
  artifacts:
    - path: 'src/components/changelog/version-accordion.tsx'
      provides: 'Multi-version accordion display'
      exports: ['VersionAccordion']
      min_lines: 60
    - path: 'src/locales/en/translation.json'
      provides: 'English changelog translations'
      contains: 'changelog'
    - path: 'src/locales/no/translation.json'
      provides: 'Norwegian changelog translations'
      contains: 'changelog'
  key_links:
    - from: 'src/components/changelog/version-accordion.tsx'
      to: 'Accordion'
      via: 'multi-version display'
      pattern: 'Accordion.*defaultValue'
    - from: 'src/components/changelog/changelog-content.tsx'
      to: 'i18next'
      via: 'translation keys'
      pattern: "useTranslation|t\\("
---

<objective>
Create the multi-version accordion, add i18n translations, and verify the complete modal UI.

Purpose: Complete the changelog modal feature with support for multiple missed versions and full internationalization.

Output: Version accordion component, i18n translation keys for English and Norwegian, verified working modal.
</objective>

<execution_context>
@/Users/danieldjupvik/.claude/get-shit-done/workflows/execute-plan.md
@/Users/danieldjupvik/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-modal-components/02-RESEARCH.md
@.planning/phases/02-modal-components/02-CONTEXT.md
@.planning/phases/02-modal-components/02-01-SUMMARY.md
@.planning/phases/02-modal-components/02-02-SUMMARY.md

@src/components/ui/accordion.tsx
@src/components/changelog/changelog-content.tsx
@src/locales/en/translation.json
@src/locales/no/translation.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create version accordion for multiple missed versions</name>
  <files>src/components/changelog/version-accordion.tsx</files>
  <action>
Create an accordion component that displays multiple changelog versions with the latest expanded.

Requirements:

1. Accept array of versions with their changelog data
2. Use Accordion with `type="single"` and `collapsible` props
3. Set `defaultValue="item-0"` to expand the first (latest) item
4. Show version + date in accordion trigger: "v0.2.0 - January 15, 2026"
5. Render ChangelogContent inside each AccordionContent
6. Implement "+ N older versions" collapse for 5+ versions

Props interface:

```typescript
interface VersionAccordionProps {
  versions: Array<{
    version: string
    date: string
    entries: {
      features?: string[]
      fixes?: string[]
      improvements?: string[]
    }
  }>
  onDismiss: () => void
}
```

Collapse logic (from CONTEXT.md and RESEARCH.md):

- If versions.length <= 4: show all versions
- If versions.length >= 5: show first 3, then "+ {n} older versions" button
- Clicking the button reveals all versions

Use formatChangelogDate for the date in accordion triggers.

Include TSDoc documentation. Use translation keys for "older versions" text.
</action>
<verify>

```bash
# Verify file exists
ls -la src/components/changelog/version-accordion.tsx

# Verify Accordion usage
grep -E "Accordion|AccordionItem|AccordionTrigger|AccordionContent" src/components/changelog/version-accordion.tsx

# Verify defaultValue for first item expanded
grep "defaultValue" src/components/changelog/version-accordion.tsx

# Verify collapse logic
grep -E "older.*version|showAll|slice" src/components/changelog/version-accordion.tsx

# Type check
bun run build 2>&1 | head -20
```

  </verify>
  <done>
VersionAccordion component displays multiple versions with shadcn Accordion. Latest version expanded by default (defaultValue="item-0"), older versions collapsed. 5+ versions shows first 3 with "+ N older versions" expand button.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add i18n translation keys for changelog UI</name>
  <files>
    src/locales/en/translation.json
    src/locales/no/translation.json
  </files>
  <action>
Add translation keys for all changelog UI text in both English and Norwegian.

Keys to add under a new "changelog" namespace:

English (src/locales/en/translation.json):

```json
{
  "changelog": {
    "title": "What's New in v{{version}}",
    "categories": {
      "features": "New Features",
      "fixes": "Bug Fixes",
      "improvements": "Improvements"
    },
    "dismiss": "Got it",
    "showMore": "Show more",
    "showLess": "Show less",
    "olderVersions": "+ {{count}} older versions",
    "versionDate": "v{{version}} - {{date}}"
  }
}
```

Norwegian (src/locales/no/translation.json):

```json
{
  "changelog": {
    "title": "Nytt i v{{version}}",
    "categories": {
      "features": "Nye funksjoner",
      "fixes": "Feilrettinger",
      "improvements": "Forbedringer"
    },
    "dismiss": "Skjonnjer",
    "showMore": "Vis mer",
    "showLess": "Vis mindre",
    "olderVersions": "+ {{count}} eldre versjoner",
    "versionDate": "v{{version}} - {{date}}"
  }
}
```

Note: i18next uses `{{variable}}` interpolation syntax.

After adding keys, update the changelog components to use `useTranslation` hook and `t()` function instead of hardcoded strings:

- changelog-content.tsx: title, category labels, dismiss button
- changelog-entry.tsx: show more/less
- version-accordion.tsx: older versions, version date label

Import pattern: `import { useTranslation } from 'react-i18next'`
</action>
<verify>

```bash
# Verify English translations
grep -A 15 '"changelog"' src/locales/en/translation.json

# Verify Norwegian translations
grep -A 15 '"changelog"' src/locales/no/translation.json

# Verify components use useTranslation
grep "useTranslation" src/components/changelog/changelog-content.tsx
grep "useTranslation" src/components/changelog/changelog-entry.tsx
grep "useTranslation" src/components/changelog/version-accordion.tsx

# Type check
bun run build 2>&1 | head -20
```

  </verify>
  <done>
Both en and no translation files have changelog namespace with all UI strings. Components updated to use useTranslation hook and t() function for all user-visible text.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Verify changelog modal UI</name>
  <what-built>
Complete changelog modal with:
- Responsive Dialog/Drawer based on screen size
- Version header with formatted date
- Categorized entries with colored badges and icons
- Text truncation with "Show more" toggle
- Multi-version accordion (if applicable)
- "Got it" dismiss button
- English and Norwegian translations
  </what-built>
  <how-to-verify>
1. Start dev server: `bun dev`
2. Create a test file to render the modal (or use browser console)
3. Test on desktop (>= 768px):
   - Modal renders as centered Dialog
   - Click X button - modal closes
   - Press Escape - modal closes
   - Click backdrop - modal closes
   - Version shows in header
   - Categories have colored badges with icons
4. Test on mobile (< 768px, use DevTools responsive mode):
   - Modal renders as bottom Drawer
   - Same dismissal behaviors work
   - Content scrolls if needed
5. Test long entry truncation:
   - Long text shows 2 lines with "Show more"
   - Click "Show more" - text expands
   - Click "Show less" - text collapses
6. Test language switch:
   - Change language to Norwegian
   - All UI text updates (category names, button labels)
   - Date format changes to Norwegian style
  </how-to-verify>
  <resume-signal>Type "approved" if modal works correctly, or describe specific issues to fix</resume-signal>
</task>

</tasks>

<verification>
After all tasks complete:

1. VersionAccordion shows multiple versions with latest expanded
2. 5+ versions collapses older with expand button
3. All changelog UI text uses i18n translation keys
4. Both English and Norwegian translations work
5. Human verified: modal looks and functions correctly
6. `bun run build` passes
7. `bun run lint` passes
   </verification>

<success_criteria>

- Multiple missed versions appear in accordion format
- Latest version expanded, older collapsed
- 5+ versions shows "+ N older versions" button
- All UI text translatable (tested with language switch)
- Human approval of visual and functional behavior
- No new TypeScript or lint errors
  </success_criteria>

<output>
After completion, create `.planning/phases/02-modal-components/02-03-SUMMARY.md`
</output>
