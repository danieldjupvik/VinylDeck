---
phase: 02-modal-components
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/dialog.tsx
  - src/components/ui/drawer.tsx
  - src/components/ui/accordion.tsx
  - src/components/ui/badge.tsx
  - src/lib/date-format.ts
autonomous: true

must_haves:
  truths:
    - 'Dialog component can render with open/onOpenChange props'
    - 'Drawer component can render with open/onOpenChange props'
    - 'Accordion component can render with defaultValue for initial open item'
    - 'Badge renders feature/fix/improvement variants with distinct colors'
    - 'Date formatter outputs localized date string based on i18n language'
  artifacts:
    - path: 'src/components/ui/dialog.tsx'
      provides: 'Desktop modal component'
      exports:
        [
          'Dialog',
          'DialogContent',
          'DialogHeader',
          'DialogTitle',
          'DialogDescription',
          'DialogFooter',
          'DialogClose'
        ]
    - path: 'src/components/ui/drawer.tsx'
      provides: 'Mobile drawer component'
      exports:
        [
          'Drawer',
          'DrawerContent',
          'DrawerHeader',
          'DrawerTitle',
          'DrawerDescription',
          'DrawerFooter',
          'DrawerClose'
        ]
    - path: 'src/components/ui/accordion.tsx'
      provides: 'Collapsible accordion component'
      exports:
        ['Accordion', 'AccordionItem', 'AccordionTrigger', 'AccordionContent']
    - path: 'src/components/ui/badge.tsx'
      provides: 'Badge with category variants'
      contains: 'variant.*feature'
    - path: 'src/lib/date-format.ts'
      provides: 'Changelog date formatting'
      exports: ['formatChangelogDate']
  key_links:
    - from: 'src/lib/date-format.ts'
      to: 'i18next'
      via: 'i18n.language for locale detection'
      pattern: "i18n\\.language"
---

<objective>
Install shadcn UI components and create foundation utilities for the changelog modal.

Purpose: Establish the component primitives (Dialog, Drawer, Accordion) and utilities (Badge variants, date formatting) that the changelog UI will build upon.

Output: Three new shadcn components, extended Badge with category colors, and a locale-aware date formatter.
</objective>

<execution_context>
@/Users/danieldjupvik/.claude/get-shit-done/workflows/execute-plan.md
@/Users/danieldjupvik/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-modal-components/02-RESEARCH.md

@src/components/ui/badge.tsx
@src/providers/i18n-provider.tsx
@src/components/ui/alert-dialog.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install shadcn Dialog, Drawer, and Accordion components</name>
  <files>
    src/components/ui/dialog.tsx
    src/components/ui/drawer.tsx
    src/components/ui/accordion.tsx
  </files>
  <action>
Run the shadcn CLI to install all three components in a single command:

```bash
bunx shadcn add dialog drawer accordion
```

This will:

- Install `vaul` package (Drawer dependency)
- Install `@radix-ui/react-accordion` package
- Create dialog.tsx, drawer.tsx, accordion.tsx in src/components/ui/

After installation, verify each file exists and exports the expected components. The shadcn components use the project's existing styling patterns (data-slot attributes, cn() utility, Tailwind classes).

Do NOT modify the generated files beyond what shadcn produces - they follow the project's conventions automatically.
</action>
<verify>

```bash
# Verify files exist
ls -la src/components/ui/dialog.tsx src/components/ui/drawer.tsx src/components/ui/accordion.tsx

# Verify packages installed
grep -E '"vaul"|"@radix-ui/react-accordion"' package.json

# Verify exports
grep "export" src/components/ui/dialog.tsx | head -5
grep "export" src/components/ui/drawer.tsx | head -5
grep "export" src/components/ui/accordion.tsx | head -5
```

  </verify>
  <done>
Three shadcn components installed: dialog.tsx exports Dialog/DialogContent/DialogHeader/DialogTitle/DialogDescription/DialogFooter/DialogClose, drawer.tsx exports Drawer/DrawerContent/DrawerHeader/DrawerTitle/DrawerDescription/DrawerFooter/DrawerClose, accordion.tsx exports Accordion/AccordionItem/AccordionTrigger/AccordionContent.
  </done>
</task>

<task type="auto">
  <name>Task 2: Extend Badge component with changelog category variants</name>
  <files>src/components/ui/badge.tsx</files>
  <action>
Add three new variants to the existing badgeVariants CVA configuration for changelog categories:

1. `feature` - Emerald/green tones for "New Features"
2. `fix` - Amber/yellow tones for "Bug Fixes"
3. `improvement` - Blue tones for "Improvements"

Use the pattern from RESEARCH.md:

```typescript
feature: 'border-transparent bg-emerald-500/15 text-emerald-700 dark:bg-emerald-500/20 dark:text-emerald-400',
fix: 'border-transparent bg-amber-500/15 text-amber-700 dark:bg-amber-500/20 dark:text-amber-400',
improvement: 'border-transparent bg-blue-500/15 text-blue-700 dark:bg-blue-500/20 dark:text-blue-400'
```

These follow the existing variant pattern (border-transparent, bg with opacity, text color, dark mode overrides). Add them after the existing `outline` variant.

Do NOT change the component function signature or existing variants - only add to the variants object.
</action>
<verify>

```bash
# Verify all three variants exist
grep -E "feature:|fix:|improvement:" src/components/ui/badge.tsx
```

  </verify>
  <done>
Badge component has three new variants: feature (emerald), fix (amber), improvement (blue). Each has light and dark mode colors with opacity backgrounds.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create date formatting utility with i18n locale support</name>
  <files>src/lib/date-format.ts</files>
  <action>
Create a new utility file for changelog date formatting that respects the app's current language.

The utility must:

1. Import i18next from the i18n provider
2. Map i18n language codes ('en', 'no') to Intl locale codes ('en-US', 'nb-NO')
3. Format dates using Intl.DateTimeFormat with { year: 'numeric', month: 'long', day: 'numeric' }
4. Include TSDoc documentation per project conventions

```typescript
/**
 * Formats a date string for changelog display using the current i18n language.
 *
 * @param dateString - ISO date string (e.g., "2026-01-29")
 * @returns Localized date string (e.g., "January 29, 2026" or "29. januar 2026")
 */
export function formatChangelogDate(dateString: string): string {
  // Implementation from RESEARCH.md code example
}
```

The locale map should handle:

- 'en' -> 'en-US' (January 29, 2026)
- 'no' -> 'nb-NO' (29. januar 2026)
- Default fallback to 'en-US'

Use i18n.language (not i18n.resolvedLanguage) to match how the app detects language.
</action>
<verify>

```bash
# Verify file exists and exports the function
grep "export function formatChangelogDate" src/lib/date-format.ts

# Verify i18n import
grep "i18n" src/lib/date-format.ts

# Verify locale mapping
grep -E "en.*en-US|no.*nb-NO" src/lib/date-format.ts

# Type check
bun run build 2>&1 | head -20
```

  </verify>
  <done>
formatChangelogDate utility exists in src/lib/date-format.ts. It imports i18n, maps language codes to Intl locales, and formats dates with year/month/day. Build passes with no type errors.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. All three shadcn components installed and exporting correctly
2. Badge has feature/fix/improvement variants
3. Date formatter works with i18n language detection
4. `bun run build` passes
5. `bun run lint` passes (or only has pre-existing warnings)
   </verification>

<success_criteria>

- Dialog, Drawer, Accordion components available for import from @/components/ui/\*
- Badge renders `<Badge variant="feature">` with emerald colors
- `formatChangelogDate("2026-01-29")` returns localized string based on i18n.language
- No new TypeScript or lint errors introduced
  </success_criteria>

<output>
After completion, create `.planning/phases/02-modal-components/02-01-SUMMARY.md`
</output>
